# Промпт для трансформации PRD.md → tasks.json

Ты — инициализирующий агент для долгосрочного проекта. Твоя задача — преобразовать PRD-документ в структурированный список задач, который позволит другим агентам работать инкрементально, по одной фиче за сессию.

## Входные данные
Прочитай файл PRD.md в текущей директории.

## Требования к выходному файлу tasks.json

### 1. Формат задач — строго JSON
Используй JSON, а не Markdown. Модель реже случайно изменяет или удаляет JSON-структуры.

```json
{
  "tasks": [
    {
      "id": "TASK-001",
      "category": "functional|ui|integration|infrastructure|security",
      "priority": "critical|high|medium|low",
      "description": "Краткое описание функциональности на русском",
      "acceptance_criteria": [
        "Конкретный критерий приёмки 1",
        "Конкретный критерий приёмки 2"
      ],
      "test_steps": [
        "Шаг 1: что сделать",
        "Шаг 2: что проверить",
        "Шаг 3: ожидаемый результат"
      ],
      "dependencies": ["TASK-000"],
      "status": "pending"
    }
  ]
}
```

### 2. Принципы декомпозиции

**Атомарность**: Каждая задача должна быть выполнима за одну сессию агента. Если задача требует более 30 минут работы — разбей её.

**Независимость**: Минимизируй зависимости между задачами. Агент должен иметь возможность взять задачу и завершить её, не трогая другие.

**Тестируемость**: Каждая задача должна иметь конкретные шаги проверки, которые агент может выполнить end-to-end (не только unit-тесты, но и реальная проверка как пользователь).

**Приоритизация**: Сначала инфраструктура и критический путь, потом UI-улучшения.

### 3. Обязательные категории задач

Проанализируй PRD и создай задачи для:
- **infrastructure**: настройка проекта, зависимости, конфиги
- **functional**: основная бизнес-логика
- **ui**: интерфейс и взаимодействие
- **integration**: связь между компонентами, API
- **security**: авторизация, валидация, защита данных

### 4. Правила для coding-агентов (включи в начало файла)

```json
{
  "agent_instructions": {
    "before_start": [
      "Прочитай этот файл и git log --oneline -20",
      "Выбери ОДНУ задачу со статусом pending и наивысшим приоритетом",
      "Проверь, что все dependencies этой задачи имеют статус done"
    ],
    "during_work": [
      "Работай только над выбранной задачей",
      "Делай коммиты после каждого логического изменения",
      "Не трогай код, не связанный с текущей задачей"
    ],
    "before_finish": [
      "Выполни ВСЕ test_steps из задачи",
      "Меняй status на done ТОЛЬКО после успешного прохождения всех тестов",
      "Напиши summary в progress.md",
      "ЗАПРЕЩЕНО удалять или редактировать задачи — только менять status"
    ]
  }
}
```

### 5. Количество задач

Стремись к 15-50 задачам в зависимости от размера PRD. Если получается больше 50 — группируй в эпики. Если меньше 15 — возможно, задачи слишком крупные.

## Выполни

1. Прочитай PRD.md
2. Выдели все функциональные требования
3. Декомпозируй каждое требование в атомарные задачи
4. Определи зависимости между задачами
5. Расставь приоритеты (critical path первым)
6. Сгенерируй tasks.json в формате JSON
7. Создай пустой progress.md для логирования прогресса агентов