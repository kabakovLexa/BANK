# PRD — Банковское Веб-Приложение «BankFlow»

**Версия документа:** 1.0  
**Дата:** 20 февраля 2026  
**Тип проекта:** Портфолио (production-grade quality)  
**Срок разработки:** 1 месяц  
**Команда:** Командная разработка

---

## 1. Обзор приложения и цели

### 1.1 Описание
BankFlow — полнофункциональное банковское веб-приложение для юридических лиц и малого бизнеса. Приложение имитирует реальный интернет-банк с полным набором банковских операций: управление счетами, депозитами, кредитами, банковскими картами, заказ документов и налоговая поддержка.

### 1.2 Цели проекта
- Продемонстрировать владение Java Spring Boot + React + PostgreSQL на уровне production
- Показать понимание финансовой доменной области (транзакции, ACID, безопасность)
- Реализовать трёхролевую систему (Клиент, Оператор, Администратор)
- Создать UI/UX уровня Альфа-Банка с собственной цветовой схемой

### 1.3 Ключевые метрики успеха
- Все CRUD-операции работают корректно с ACID-транзакциями
- Время отклика API < 500ms для 95% запросов
- Корректный расчёт процентов по депозитам и кредитам
- Полный цикл: регистрация → открытие счёта → операции → выписка

---

## 2. Целевая аудитория

### 2.1 Первичная аудитория
- **Юридические лица** — компании, нуждающиеся в расчётных счетах, кредитах, управлении финансами
- **Малый бизнес** — ИП и небольшие компании с потребностью в простом и удобном банкинге

### 2.2 Пользовательские роли

| Роль | Описание | Ключевые возможности |
|------|----------|---------------------|
| **Клиент** | Юрлицо / ИП | Управление счетами, картами, депозитами, кредитами, заказ документов, налоговая помощь |
| **Оператор** | Сотрудник банка | Обработка заявок, управление клиентами, одобрение операций, формирование документов |
| **Администратор** | Системный администратор | Управление пользователями, настройка продуктов банка, мониторинг системы, управление ролями |

---

## 3. Основные функции и функциональность

### 3.1 Модуль «Счета»

**Описание:** Управление банковскими счетами юридических лиц.

**Функциональные требования:**
- Открытие расчётного счёта (с генерацией номера в формате 20 цифр)
- Просмотр баланса в реальном времени
- История операций с фильтрацией по дате, типу, сумме, контрагенту
- Переводы между своими счетами (мгновенно)
- Переводы другим клиентам банка
- Переводы в другие банки (имитация с задержкой)
- Неснижаемый остаток — установка минимального баланса, ниже которого нельзя совершать операции
- Блокировка / разблокировка счёта (оператором / админом)
- Экспорт выписки в PDF

**Acceptance Criteria:**
- Клиент может открыть счёт и получить уникальный номер
- Баланс обновляется мгновенно после операции
- Система не позволяет перевод, если баланс после операции < неснижаемого остатка
- История операций пагинирована (по 20 записей) с фильтрами
- Все финансовые операции атомарны (ACID)

**Модель данных:**

```
Account {
  id: UUID (PK)
  account_number: String (20 цифр, unique)
  client_id: UUID (FK → Client)
  account_type: Enum [CHECKING, SAVINGS, DEPOSIT]
  currency: Enum [RUB, USD, EUR]
  balance: BigDecimal (precision 19, scale 2)
  min_balance: BigDecimal (неснижаемый остаток, default 0)
  status: Enum [ACTIVE, BLOCKED, CLOSED]
  opened_at: Timestamp
  closed_at: Timestamp (nullable)
}
```

**Technical Considerations:**
- Использовать `BigDecimal` для всех денежных операций (не `float`/`double`)
- Оптимистическая блокировка (`@Version`) для предотвращения race conditions
- Все переводы — в рамках `@Transactional` с уровнем изоляции `SERIALIZABLE`
- Индексы на `account_number`, `client_id`, `status`

---

### 3.2 Модуль «Депозиты»

**Описание:** Управление банковскими вкладами с начислением процентов.

**Функциональные требования:**
- Открытие депозита с выбором условий (срок, ставка, капитализация)
- Типы депозитов: срочный, до востребования, с капитализацией, без капитализации
- Автоматический расчёт процентов
- Досрочное закрытие депозита (с пересчётом по ставке до востребования)
- Пролонгация депозита (автоматическая и ручная)
- Просмотр графика начислений

**Acceptance Criteria:**
- Клиент может выбрать тип депозита и увидеть предварительный расчёт дохода
- Проценты рассчитываются корректно (простые и сложные)
- При досрочном закрытии применяется сниженная ставка
- Оператор может создавать новые продукты-депозиты с различными условиями

**Модель данных:**

```
DepositProduct {
  id: UUID (PK)
  name: String
  min_amount: BigDecimal
  max_amount: BigDecimal
  interest_rate: BigDecimal (годовая, %)
  min_term_months: Integer
  max_term_months: Integer
  capitalization: Boolean
  early_withdrawal_rate: BigDecimal
  is_active: Boolean
}

Deposit {
  id: UUID (PK)
  client_id: UUID (FK → Client)
  product_id: UUID (FK → DepositProduct)
  source_account_id: UUID (FK → Account)
  amount: BigDecimal
  interest_rate: BigDecimal
  start_date: Date
  end_date: Date
  status: Enum [ACTIVE, CLOSED, PROLONGED]
  auto_prolongation: Boolean
  accrued_interest: BigDecimal
}
```

**Technical Considerations:**
- Формула простых процентов: `amount * rate * days / 365 / 100`
- Формула сложных процентов (капитализация): `amount * (1 + rate/100/12)^months - amount`
- Реализовать Spring Scheduler (`@Scheduled`) для ежедневного начисления процентов
- Хранить историю начислений для аудита

---

### 3.3 Модуль «Банковские карты»

**Описание:** Выпуск и управление банковскими картами, привязанными к счетам.

**Функциональные требования:**
- Заказ виртуальной / физической карты (имитация)
- Привязка карты к счёту
- Типы карт: Visa, Mastercard (имитация)
- Просмотр данных карты (маскированный номер, срок действия)
- Установка лимитов (дневной, месячный)
- Блокировка / разблокировка карты
- Перевыпуск карты
- История операций по карте

**Acceptance Criteria:**
- Клиент может заказать карту и получить её данные (имитация)
- Номер карты генерируется по алгоритму Луна
- Лимиты применяются корректно (операция отклоняется при превышении)
- Заблокированная карта не может совершать операции

**Модель данных:**

```
Card {
  id: UUID (PK)
  card_number: String (16 цифр, encrypted)
  account_id: UUID (FK → Account)
  client_id: UUID (FK → Client)
  card_type: Enum [VISA, MASTERCARD]
  card_category: Enum [VIRTUAL, PHYSICAL]
  holder_name: String
  expiry_date: Date
  cvv: String (encrypted)
  daily_limit: BigDecimal
  monthly_limit: BigDecimal
  status: Enum [ACTIVE, BLOCKED, EXPIRED, PENDING_ISSUE]
  issued_at: Timestamp
}
```

**Technical Considerations:**
- Номера карт и CVV хранить в зашифрованном виде (AES-256)
- Генерация номеров по алгоритму Луна для реалистичности
- При показе клиенту маскировать номер: `**** **** **** 1234`
- Лимиты проверять через отдельный сервис перед каждой операцией

---

### 3.4 Модуль «Кредиты»

**Описание:** Оформление и управление кредитами с различными условиями.

**Функциональные требования:**
- Типы кредитов: бизнес-кредит, кредитная линия, кредит под недвижимость (ипотека)
- Подача заявки на кредит с загрузкой документов
- Кредитный скоринг (упрощённая модель)
- Графики платежей: аннуитетные и дифференцированные
- Досрочное погашение (полное и частичное)
- Просмотр остатка долга и графика
- Начисление пени за просрочку (имитация)

**Acceptance Criteria:**
- Клиент может подать заявку и увидеть предварительный расчёт
- Оператор может одобрить / отклонить заявку
- Графики платежей рассчитываются корректно для обоих типов
- Досрочное погашение пересчитывает график
- Ипотека имеет отдельные условия: залог, страхование (имитация)

**Модель данных:**

```
CreditProduct {
  id: UUID (PK)
  name: String
  type: Enum [BUSINESS, CREDIT_LINE, MORTGAGE]
  min_amount: BigDecimal
  max_amount: BigDecimal
  min_rate: BigDecimal
  max_rate: BigDecimal
  min_term_months: Integer
  max_term_months: Integer
  requires_collateral: Boolean
  is_active: Boolean
}

Credit {
  id: UUID (PK)
  client_id: UUID (FK → Client)
  product_id: UUID (FK → CreditProduct)
  target_account_id: UUID (FK → Account)
  amount: BigDecimal
  interest_rate: BigDecimal
  term_months: Integer
  payment_type: Enum [ANNUITY, DIFFERENTIATED]
  status: Enum [PENDING, APPROVED, ACTIVE, CLOSED, OVERDUE, REJECTED]
  approved_by: UUID (FK → User, nullable)
  disbursed_at: Timestamp (nullable)
  collateral_description: String (nullable, для ипотеки)
  remaining_amount: BigDecimal
}

PaymentSchedule {
  id: UUID (PK)
  credit_id: UUID (FK → Credit)
  payment_number: Integer
  due_date: Date
  total_payment: BigDecimal
  principal_part: BigDecimal
  interest_part: BigDecimal
  remaining_debt: BigDecimal
  status: Enum [UPCOMING, PAID, OVERDUE]
  paid_at: Timestamp (nullable)
}
```

**Technical Considerations:**
- Аннуитет: `P = S * (r * (1+r)^n) / ((1+r)^n - 1)`, где r = годовая ставка / 12 / 100
- Дифференцированный: основной долг = S/n, проценты = остаток * r / 12
- Скоринг: учитывать оборот по счетам, срок обслуживания, наличие других кредитов
- Spring Scheduler для проверки просроченных платежей и начисления пени

---

### 3.5 Модуль «Заказ документов»

**Описание:** Формирование и заказ банковских документов.

**Функциональные требования:**
- Типы документов: выписка по счёту, справка об остатке, справка об оборотах, справка об отсутствии задолженности, реквизиты счёта
- Выбор периода для выписок
- Генерация PDF с фирменным оформлением банка
- Статус заявки (для справок, требующих обработки оператором)
- История заказов документов

**Acceptance Criteria:**
- Клиент может заказать документ и получить PDF
- Выписки формируются автоматически (мгновенно)
- Справки требуют одобрения оператора
- PDF содержит логотип, печать (имитация), подпись, дату

**Модель данных:**

```
DocumentOrder {
  id: UUID (PK)
  client_id: UUID (FK → Client)
  account_id: UUID (FK → Account, nullable)
  document_type: Enum [STATEMENT, BALANCE_CERT, TURNOVER_CERT, NO_DEBT_CERT, REQUISITES]
  period_from: Date (nullable)
  period_to: Date (nullable)
  status: Enum [PENDING, PROCESSING, READY, REJECTED]
  processed_by: UUID (FK → User, nullable)
  file_path: String (nullable)
  created_at: Timestamp
  completed_at: Timestamp (nullable)
}
```

**Technical Considerations:**
- Использовать библиотеку **iText** или **Apache PDFBox** для генерации PDF
- Шаблоны документов хранить как HTML → конвертировать в PDF (Thymeleaf + Flying Saucer)
- Файлы хранить в файловой системе или S3-совместимом хранилище (MinIO для dev)

---

### 3.6 Модуль «Помощь по налогам»

**Описание:** Инструменты для налогового планирования и расчётов.

**Функциональные требования:**
- Налоговый калькулятор (УСН 6%, УСН 15%, ОСНО, патент)
- Календарь налоговых платежей с напоминаниями
- Формирование платёжных поручений для уплаты налогов
- Справочник по налоговым ставкам и срокам
- Расчёт налоговой нагрузки на основе оборотов по счёту

**Acceptance Criteria:**
- Калькулятор корректно рассчитывает налог для каждого режима
- Календарь показывает ближайшие сроки уплаты
- Платёжное поручение формируется с правильными реквизитами ФНС (имитация)

**Модель данных:**

```
TaxCalculation {
  id: UUID (PK)
  client_id: UUID (FK → Client)
  tax_regime: Enum [USN_6, USN_15, OSNO, PATENT]
  period: String (e.g., "Q1 2026")
  revenue: BigDecimal
  expenses: BigDecimal (для УСН 15% и ОСНО)
  calculated_tax: BigDecimal
  created_at: Timestamp
}

TaxCalendarEvent {
  id: UUID (PK)
  tax_type: String
  description: String
  due_date: Date
  tax_regime: Enum [USN_6, USN_15, OSNO, PATENT]
}
```

**Technical Considerations:**
- Налоговые ставки и сроки хранить в конфигурации (не хардкодить)
- Напоминания через систему уведомлений (email / in-app)

---

### 3.7 Модуль «Неснижаемый остаток»

**Описание:** Управление минимальным балансом на счетах.

**Функциональные требования:**
- Установка неснижаемого остатка клиентом или оператором
- Начисление повышенного процента на сумму неснижаемого остатка
- Блокировка операций, которые приведут к снижению баланса ниже установленного минимума
- История изменений неснижаемого остатка

**Acceptance Criteria:**
- Система отклоняет перевод, если результирующий баланс < min_balance
- Клиент видит отдельно: доступный баланс и неснижаемый остаток
- Повышенный процент начисляется корректно

**Technical Considerations:**
- Доступный баланс = balance - min_balance
- Проверка в сервисном слое перед каждой дебетовой операцией
- Реализовать как часть модуля «Счета» (не отдельный микросервис)

---

## 4. Рекомендации по техническому стеку

### 4.1 Backend

| Технология | Назначение | Обоснование |
|-----------|-----------|-------------|
| **Java 17+** | Язык | LTS-версия, современные возможности (records, sealed classes, pattern matching) |
| **Spring Boot 3.x** | Фреймворк | Стандарт индустрии, богатая экосистема |
| **Spring Security** | Безопасность | JWT + аутентификация, авторизация по ролям |
| **Spring Data JPA** | ORM | Работа с PostgreSQL, поддержка транзакций |
| **Hibernate** | ORM (под капотом JPA) | Оптимистическая блокировка, кэширование |
| **Flyway** | Миграции БД | Версионирование схемы базы данных |
| **MapStruct** | Маппинг DTO | Автогенерация маппингов Entity ↔ DTO |
| **Lombok** | Утилиты | Сокращение boilerplate-кода |
| **Spring Scheduler** | Планировщик | Начисление процентов, проверка просрочек |
| **SpringDoc OpenAPI** | Документация API | Автогенерация Swagger UI |

### 4.2 Frontend

| Технология | Назначение | Обоснование |
|-----------|-----------|-------------|
| **React 18+** | UI-фреймворк | Компонентный подход, большое комьюнити |
| **TypeScript** | Язык | Типизация, снижение ошибок |
| **Redux Toolkit** | State management | Управление состоянием, RTK Query для API-вызовов |
| **React Router v6** | Маршрутизация | SPA-навигация |
| **Ant Design** или **MUI** | UI-библиотека | Готовые компоненты в стиле банковских приложений |
| **Axios** | HTTP-клиент | Запросы к API с интерцепторами |
| **Chart.js** или **Recharts** | Графики | Визуализация финансовых данных |
| **React-PDF** | PDF-просмотр | Отображение сгенерированных документов |

### 4.3 База данных и инфраструктура

| Технология | Назначение | Обоснование |
|-----------|-----------|-------------|
| **PostgreSQL 15+** | Основная БД | ACID, надёжность, поддержка JSON |
| **Redis** | Кэширование | Сессии, курсы валют, кэш справочников |
| **MinIO** | Хранилище файлов | S3-совместимое хранение PDF (dev-среда) |
| **Docker + Docker Compose** | Контейнеризация | Единообразие среды разработки |
| **Nginx** | Reverse proxy | Проксирование фронта и бэка |

### 4.4 Инструменты разработки

| Технология | Назначение |
|-----------|-----------|
| **Git + GitHub/GitLab** | Версионирование и CI/CD |
| **JUnit 5 + Mockito** | Юнит-тестирование |
| **Testcontainers** | Интеграционные тесты с PostgreSQL |
| **SonarQube** (опционально) | Качество кода |
| **Postman** | Тестирование API |

---

## 5. Концептуальная модель данных

### 5.1 Основные сущности и связи

```
User (1) ──── (1) Client
  │
  ├── role: ROLE_CLIENT / ROLE_OPERATOR / ROLE_ADMIN
  │
Client (1) ──── (*) Account
  │                  │
  │                  ├── (*) Card
  │                  ├── (*) Transaction
  │                  └── min_balance (неснижаемый остаток)
  │
  ├── (*) Deposit
  ├── (*) Credit ──── (*) PaymentSchedule
  ├── (*) DocumentOrder
  └── (*) TaxCalculation
```

### 5.2 Сущность «Пользователь / Клиент»

```
User {
  id: UUID (PK)
  email: String (unique)
  password: String (BCrypt hash)
  role: Enum [ROLE_CLIENT, ROLE_OPERATOR, ROLE_ADMIN]
  is_active: Boolean
  two_factor_enabled: Boolean
  two_factor_secret: String (nullable, encrypted)
  created_at: Timestamp
  last_login_at: Timestamp
}

Client {
  id: UUID (PK)
  user_id: UUID (FK → User, unique)
  company_name: String
  inn: String (10 или 12 цифр, unique)
  kpp: String (9 цифр, nullable)
  ogrn: String (13 или 15 цифр, unique)
  legal_address: String
  actual_address: String
  phone: String
  contact_person: String
  registration_date: Date
  status: Enum [ACTIVE, BLOCKED, PENDING_VERIFICATION]
}
```

### 5.3 Сущность «Транзакция»

```
Transaction {
  id: UUID (PK)
  from_account_id: UUID (FK → Account, nullable)
  to_account_id: UUID (FK → Account, nullable)
  amount: BigDecimal
  currency: Enum [RUB, USD, EUR]
  type: Enum [TRANSFER_INTERNAL, TRANSFER_EXTERNAL, DEPOSIT_OPEN, DEPOSIT_CLOSE, 
              CREDIT_DISBURSEMENT, CREDIT_PAYMENT, CARD_PAYMENT, FEE, INTEREST]
  description: String
  status: Enum [PENDING, COMPLETED, FAILED, CANCELLED]
  created_at: Timestamp
  completed_at: Timestamp (nullable)
  reference_id: String (unique, для идемпотентности)
}
```

---

## 6. Принципы UI-дизайна

### 6.1 Общие принципы
- **Референс:** Альфа-Банк для бизнеса (структура, UX-паттерны)
- **Цветовая схема:** Собственная палитра (НЕ красная как у Альфы)
- **Язык интерфейса:** Русский
- **Адаптивность:** Desktop-first, адаптация под планшеты (мобильная версия — опционально)

### 6.2 Рекомендуемая цветовая палитра

Предлагаю сине-зелёную гамму (ассоциируется с надёжностью и финансами):
- **Primary:** #1A73E8 (насыщенный синий)
- **Secondary:** #00C853 (зелёный акцент для позитивных операций)
- **Danger:** #D32F2F (красный для ошибок, отрицательных сумм)
- **Warning:** #FFA000 (оранжевый для предупреждений)
- **Background:** #F5F7FA (светло-серый фон)
- **Surface:** #FFFFFF (белые карточки)
- **Text Primary:** #1A1A2E (почти чёрный)
- **Text Secondary:** #6B7280 (серый для вторичного текста)

### 6.3 Структура интерфейса

```
┌─────────────────────────────────────────────────┐
│  Header: Логотип | Уведомления | Профиль       │
├──────────┬──────────────────────────────────────┤
│          │                                      │
│  Sidebar │   Main Content Area                  │
│          │                                      │
│  - Главная│   ┌──────────┐  ┌──────────┐       │
│  - Счета  │   │ Виджет 1 │  │ Виджет 2 │       │
│  - Карты  │   └──────────┘  └──────────┘       │
│  - Депозиты│                                    │
│  - Кредиты│   ┌─────────────────────────┐       │
│  - Документы│ │   Таблица / Контент     │       │
│  - Налоги │   └─────────────────────────┘       │
│  - Настройки│                                   │
│          │                                      │
├──────────┴──────────────────────────────────────┤
│  Footer: © BankFlow 2026                        │
└─────────────────────────────────────────────────┘
```

### 6.4 Ключевые экраны

| Экран | Содержание |
|-------|-----------|
| **Дашборд** | Общий баланс, последние операции, быстрые действия, графики |
| **Список счетов** | Карточки счетов с балансами, статусами, быстрыми действиями |
| **Детали счёта** | Баланс, неснижаемый остаток, история операций, экспорт |
| **Переводы** | Форма перевода, шаблоны, история переводов |
| **Карты** | Визуальное отображение карты, лимиты, статус |
| **Депозиты** | Калькулятор, список депозитов, график начислений |
| **Кредиты** | Калькулятор, заявка, график платежей, остаток долга |
| **Документы** | Заказ документов, статус, скачивание PDF |
| **Налоги** | Калькулятор, календарь, платёжные поручения |
| **Админ-панель** | Управление пользователями, продуктами, мониторинг |
| **Панель оператора** | Очередь заявок, обработка, поиск клиентов |

---

## 7. Интеграции со сторонними сервисами

### 7.1 Курсы валют (реальные данные)
- **API:** ЦБ РФ (https://www.cbr.ru/scripts/XML_daily.asp) — бесплатный
- **Альтернатива:** ExchangeRate-API или Open Exchange Rates (free tier)
- **Реализация:** Spring Scheduler забирает курсы 1 раз в день, кэширует в Redis
- **Отображение:** Виджет на дашборде с текущими курсами USD, EUR

### 7.2 Имитация платёжных систем Visa / Mastercard
- **Подход:** Создать mock-сервис, имитирующий ответы платёжной системы
- **Реализация:** Отдельный Spring-контроллер с задержкой ответа (100-500ms)
- **Ответы:** Рандомизированные (95% успех, 5% отказ для реалистичности)

### 7.3 Email-уведомления
- **Сервис:** Spring Boot Mail + Mailtrap (для dev) или встроенный SMTP
- **Уведомления:** Регистрация, операции свыше порога, одобрение заявок, налоговые напоминания
- **Шаблоны:** Thymeleaf HTML-шаблоны с фирменным стилем

### 7.4 SMS-уведомления (имитация)
- **Подход:** Логирование «отправленных» SMS в базу + отображение в личном кабинете
- **Реализация:** Интерфейс `SmsService` с mock-реализацией
- **Опционально:** Интеграция с Twilio (free tier) для реальных SMS

### 7.5 Генерация PDF
- **Библиотека:** iText 7 или Apache PDFBox
- **Шаблоны:** Thymeleaf → HTML → PDF (Flying Saucer / OpenHTMLtoPDF)
- **Документы:** Выписки, справки, платёжные поручения, кредитные договоры

---

## 8. Соображения по безопасности

### 8.1 Аутентификация
- JWT-токены (Access Token: 15 мин, Refresh Token: 7 дней)
- BCrypt для хэширования паролей (strength 12)
- Имитация 2FA через TOTP (Google Authenticator-совместимый)
- Rate limiting на эндпоинт `/auth/login` (5 попыток / минуту)

### 8.2 Авторизация
- Role-based access control (RBAC) через Spring Security
- Method-level security (`@PreAuthorize`)
- Клиент видит только свои данные (row-level security на уровне сервисов)

### 8.3 Защита данных
- Шифрование чувствительных данных: номера карт, CVV (AES-256)
- HTTPS (самоподписанный сертификат для dev)
- CORS-политика: только разрешённые origins
- SQL Injection защита через параметризованные запросы (JPA)
- XSS защита на фронтенде (React по умолчанию экранирует)
- CSRF-токены для форм

### 8.4 Аудит
- Логирование всех финансовых операций
- Логирование действий операторов и администраторов
- Таблица `AuditLog` с полями: who, what, when, ip_address

```
AuditLog {
  id: UUID (PK)
  user_id: UUID (FK → User)
  action: String
  entity_type: String
  entity_id: UUID
  details: JSONB
  ip_address: String
  created_at: Timestamp
}
```

---

## 9. Этапы разработки (1 месяц)

### Неделя 1: Фундамент

**Backend:**
- Инициализация Spring Boot проекта, настройка Docker Compose (PostgreSQL, Redis)
- Модели данных, миграции Flyway
- User / Client entities + Spring Security (JWT, RBAC)
- Регистрация, логин, 2FA (имитация), refresh-токены
- CRUD для счетов (Account) с неснижаемым остатком

**Frontend:**
- Инициализация React + TypeScript + Redux Toolkit
- Настройка роутинга, layout (sidebar, header)
- Страницы: логин, регистрация, дашборд (заглушки)
- Интеграция с API аутентификации
- Дизайн-система: цвета, типографика, базовые компоненты

**Результат:** Пользователь может зарегистрироваться, войти и увидеть дашборд со списком счетов.

---

### Неделя 2: Основные банковские операции

**Backend:**
- Модуль переводов (внутренние + имитация внешних) с ACID-транзакциями
- Модуль банковских карт (CRUD, генерация номеров, лимиты)
- Модуль депозитов (CRUD, калькулятор процентов)
- Spring Scheduler: начисление процентов, проверка лимитов
- Интеграция с API курсов валют ЦБ РФ

**Frontend:**
- Страница счёта: баланс, операции, переводы
- Страница карт: визуальное отображение, управление
- Страница депозитов: калькулятор, список, детали
- Виджет курсов валют на дашборде

**Результат:** Клиент может совершать переводы, управлять картами и открывать депозиты.

---

### Неделя 3: Кредиты, документы, налоги

**Backend:**
- Модуль кредитов (заявка, скоринг, графики платежей, ипотека)
- Модуль документов (генерация PDF, workflow заявок)
- Модуль налогов (калькулятор, календарь)
- Email-уведомления (Thymeleaf-шаблоны)
- Имитация SMS
- Mock-сервис платёжных систем

**Frontend:**
- Страница кредитов: калькулятор, заявка, график
- Страница документов: заказ, статус, скачивание
- Страница налогов: калькулятор, календарь
- Уведомления в интерфейсе (bell icon + dropdown)

**Результат:** Все основные модули функционируют.

---

### Неделя 4: Админка, полировка, тесты

**Backend:**
- Панель оператора: очередь заявок, обработка, поиск клиентов
- Панель админа: управление пользователями, продуктами банка, мониторинг
- Аудит-логирование
- Юнит-тесты (сервисный слой, калькуляторы)
- Интеграционные тесты (Testcontainers)
- API-документация (Swagger)

**Frontend:**
- Интерфейс оператора
- Интерфейс администратора
- Адаптивность (планшет)
- Анимации, переходы, loading-состояния
- Обработка ошибок (error boundaries, toast-уведомления)

**Результат:** Полностью готовое приложение с тремя ролями, тестами и документацией.

---

## 10. API-структура (основные эндпоинты)

### Аутентификация
```
POST   /api/v1/auth/register          — Регистрация
POST   /api/v1/auth/login             — Вход
POST   /api/v1/auth/refresh           — Обновление токена
POST   /api/v1/auth/2fa/setup         — Настройка 2FA
POST   /api/v1/auth/2fa/verify        — Проверка 2FA-кода
POST   /api/v1/auth/logout            — Выход
```

### Счета
```
GET    /api/v1/accounts               — Список счетов клиента
POST   /api/v1/accounts               — Открытие счёта
GET    /api/v1/accounts/{id}          — Детали счёта
PATCH  /api/v1/accounts/{id}/min-balance — Установка неснижаемого остатка
GET    /api/v1/accounts/{id}/transactions — История операций
POST   /api/v1/accounts/{id}/block    — Блокировка (оператор)
```

### Переводы
```
POST   /api/v1/transfers/internal     — Перевод между своими счетами
POST   /api/v1/transfers/bank         — Перевод внутри банка
POST   /api/v1/transfers/external     — Перевод в другой банк
```

### Карты
```
GET    /api/v1/cards                  — Список карт
POST   /api/v1/cards                  — Заказ карты
GET    /api/v1/cards/{id}             — Детали карты
PATCH  /api/v1/cards/{id}/limits      — Установка лимитов
POST   /api/v1/cards/{id}/block       — Блокировка карты
POST   /api/v1/cards/{id}/reissue     — Перевыпуск
```

### Депозиты
```
GET    /api/v1/deposits/products      — Список продуктов
POST   /api/v1/deposits/calculate     — Калькулятор доходности
POST   /api/v1/deposits               — Открытие депозита
GET    /api/v1/deposits/{id}          — Детали депозита
POST   /api/v1/deposits/{id}/close    — Досрочное закрытие
```

### Кредиты
```
GET    /api/v1/credits/products       — Список кредитных продуктов
POST   /api/v1/credits/calculate      — Калькулятор платежей
POST   /api/v1/credits/apply          — Подача заявки
GET    /api/v1/credits/{id}           — Детали кредита
GET    /api/v1/credits/{id}/schedule  — График платежей
POST   /api/v1/credits/{id}/early-payment — Досрочное погашение
```

### Документы
```
GET    /api/v1/documents/types        — Типы документов
POST   /api/v1/documents/order        — Заказ документа
GET    /api/v1/documents/orders       — Список заказов
GET    /api/v1/documents/{id}/download — Скачивание PDF
```

### Налоги
```
POST   /api/v1/tax/calculate          — Расчёт налога
GET    /api/v1/tax/calendar           — Налоговый календарь
GET    /api/v1/tax/history            — История расчётов
```

### Оператор
```
GET    /api/v1/operator/applications  — Очередь заявок
PATCH  /api/v1/operator/applications/{id} — Обработка заявки
GET    /api/v1/operator/clients       — Поиск клиентов
```

### Администратор
```
GET    /api/v1/admin/users            — Управление пользователями
PATCH  /api/v1/admin/users/{id}       — Изменение роли / статуса
GET    /api/v1/admin/products         — Управление продуктами банка
POST   /api/v1/admin/products         — Создание продукта
GET    /api/v1/admin/audit            — Аудит-лог
GET    /api/v1/admin/stats            — Статистика системы
```

---

## 11. Потенциальные проблемы и способы их решения

| Проблема | Решение |
|----------|---------|
| **Race conditions при переводах** | Оптимистическая блокировка (`@Version`) + `SERIALIZABLE` изоляция транзакций |
| **Точность финансовых расчётов** | `BigDecimal` везде, `RoundingMode.HALF_UP`, шкала 2 для сумм |
| **Сложность расчёта графиков кредитов** | Вынести в отдельный `CalculationService`, покрыть юнит-тестами |
| **Большой объём данных в истории операций** | Пагинация, индексы на `account_id + created_at`, партиционирование (опционально) |
| **Безопасность данных карт** | AES-256 шифрование, маскирование при отображении, минимум хранимых данных |
| **Сложный UI с множеством экранов** | Компонентный подход, общая дизайн-система, переиспользуемые компоненты |
| **Сжатые сроки (1 месяц)** | Чёткое разделение по неделям, параллельная работа backend + frontend |
| **Консистентность данных** | Flyway-миграции, единая точка конфигурации, DTO-валидация |

---

## 12. Возможности будущего расширения

### Фаза 2 (после MVP)
- Мультивалютные счета с автоконвертацией
- Мобильное приложение (React Native)
- Интеграция с реальным SMTP (SendGrid / Mailgun)
- Push-уведомления (WebSocket)
- Экспорт данных в 1С / бухгалтерские системы

### Фаза 3
- Открытый API для партнёров (Open Banking)
- Интеграция с ЭЦП для документов
- Чат-бот поддержки
- Аналитика и отчёты (графики расходов, прогнозы)
- Marketplace финансовых продуктов

---

## 13. Потенциальные затраты

| Ресурс | Стоимость | Примечание |
|--------|-----------|-----------|
| **Хостинг (dev)** | Бесплатно | Docker на локальной машине |
| **PostgreSQL** | Бесплатно | Docker-контейнер |
| **Redis** | Бесплатно | Docker-контейнер |
| **API курсов валют (ЦБ РФ)** | Бесплатно | Открытый API |
| **Email (Mailtrap)** | Бесплатно | Free tier для разработки |
| **Хостинг (production demo)** | ~$5-20/мес | Railway / Render / VPS |
| **Домен** | ~$10/год | Опционально |

**Итого для разработки: $0**  
**Итого для демо-деплоя: $5-20/мес**

---

## 14. Ссылки на документацию

- [Spring Boot 3](https://docs.spring.io/spring-boot/docs/current/reference/html/)
- [Spring Security](https://docs.spring.io/spring-security/reference/index.html)
- [Spring Data JPA](https://docs.spring.io/spring-data/jpa/reference/index.html)
- [React 18](https://react.dev/)
- [Redux Toolkit](https://redux-toolkit.js.org/)
- [Ant Design](https://ant.design/) / [Material UI](https://mui.com/)
- [PostgreSQL](https://www.postgresql.org/docs/)
- [Flyway](https://documentation.red-gate.com/fd)
- [iText 7](https://itextpdf.com/resources)
- [Docker Compose](https://docs.docker.com/compose/)
- [API ЦБ РФ](https://www.cbr.ru/development/SXML/)
